

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>4.1. SciPy tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-xxx"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-xxx');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/data-analytics/scipy-basic';</script>
    <link rel="canonical" href="https://xiaoganghe.github.io/python-climate-visuals/chapters/data-analytics/scipy-basic.html" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.2. SciPy Exercise" href="scipy-exercise.html" />
    <link rel="prev" title="4. What is SciPy?" href="scipy.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/favicon.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/favicon.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Analytics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="python.html">1. Python</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="python-basic.html">1.1. Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-exercise.html">1.2. Exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="python-solution.html">1.3. Solution</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="numpy.html">2. NumPy</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="numpy-basic.html">2.1. Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="numpy-exercise.html">2.2. Exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="numpy-solution.html">2.3. Solution</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pandas.html">3. Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="pandas-basic.html">3.1. Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="pandas-exercise.html">3.2. Exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="pandas-solution.html">3.3. Solution</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="scipy.html">4. SciPy</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.1. Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="scipy-exercise.html">4.2. Exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="scipy-solution.html">4.3. Solution</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="xarray.html">5. Xarray</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="xarray-basic.html">5.1. Tutorial</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../data-visuals/matplotlib.html">1. Matplotlib</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../data-visuals/matplotlib-basic.html">1.1. Tutorial (Basic)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data-visuals/matplotlib-advanced.html">1.2. Tutorial (Advanced)</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Homework</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../homework/homework1.html">Homework 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../homework/homework2.html">Homework 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../project/FinalProject-2022Fall.html">Fall 2023</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Gallery</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../gallery/plot_weighted_river_network.html">River Network</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Others</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../others/refs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/XiaogangHe/python-climate-visuals/master?urlpath=tree/chapters/data-analytics/scipy-basic.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/XiaogangHe/python-climate-visuals" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/data-analytics/scipy-basic.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SciPy tutorial</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics">4.1.1. Descriptive Statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distributions">4.1.2. Distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-tests">4.1.3. Statistical Tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlations">4.1.4. Correlations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extreme-value-analysis">4.1.5. Extreme Value Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-extreme-values">4.1.5.1. Extract extreme values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-distribution-parameter-estimation">4.1.5.2. Fit distribution (parameter estimation)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-with-empirical-distribution">4.1.5.3. Compare with empirical distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-extreme-values-for-specific-return-periods">4.1.5.4. Estimate extreme values for specific return periods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.1.6. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="scipy-tutorial">
<h1><span class="section-number">4.1. </span>SciPy tutorial<a class="headerlink" href="#scipy-tutorial" title="Permalink to this heading">#</a></h1>
<p><a class="reference external" href="https://www.scipy.org/">SciPy</a> is the core library for scientific computing in Python. It provides many user-friendly and efficient numerical routines, such as numerical integration, interpolation, optimization, linear algebra, and <strong>statistics</strong>. These routines are composed as task-specific sub-modules in <code class="docutils literal notranslate"><span class="pre">SciPy</span></code>, such as <code class="docutils literal notranslate"><span class="pre">scipy.cluster</span></code> for vector quantization/ Kmeans, <code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code> for linear algebra routines. All <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> sub-modules depend on <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>, but are mostly independent of each other.</p>
<p><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> module contains a large number of summary and frequency statistics, probability distributions, correlation functions, statistical tests, kernel density estimation, quasi-Monte Carlo functionality, and so on.</p>
<p>In this tutorial, we will cover:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>: Statistics, Distributions, Statistical Tests and Correlations</p></li>
<li><p>Extreme Value Analysis</p></li>
</ul>
<p>The standard way of importing NumPy and one SciPy sub-module is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>scipy.stats
</pre></div>
</div>
</div>
</div>
<section id="descriptive-statistics">
<h2><span class="section-number">4.1.1. </span>Descriptive Statistics<a class="headerlink" href="#descriptive-statistics" title="Permalink to this heading">#</a></h2>
<p>When we have a new dataset in hand, we need to have a descriptive or summary view of the data. This could normally be done through two main approaches:</p>
<ol class="arabic simple">
<li><p><em><strong>The quantitative approach</strong></em> describes and summarizes data numerically using statistics. We focus on this approach in this <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> tutorial.</p></li>
<li><p><em>The visual approach</em> illustrates data with charts, plots, histograms, and other graphs. This approach is covered in the tutorial of <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p></li>
</ol>
<p>There are multiple ways to obtain descriptive statistics of the dataset in Python. Note that <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> is established based on <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> and it offers additional functionality compared to <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>. Common statistics already exist in <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> (such as <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">median</span></code>, <code class="docutils literal notranslate"><span class="pre">var</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mf">14.5</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">11.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Mean (Location Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean: &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Median (Location Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Median: &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Variance (Scale Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variance: &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>  <span class="c1">#ddof=1 provides an unbiased estimator of the variance</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[10.  14.  11.   7.   9.5]
 [ 8.   9.  17.  14.5 12. ]
 [15.   7.  11.5 10.  10.5]
 [11.  11.   9.  12.  14. ]]
Mean:  [11.    10.25  12.125 10.875 11.5  ]
Median:  [10.5  10.   11.25 11.   11.25]
Variance:  [ 8.66666667  8.91666667 11.72916667 10.0625      3.83333333]
</pre></div>
</div>
</div>
</div>
<p>For more complicated statistics such as <code class="docutils literal notranslate"><span class="pre">iqr</span></code>, <code class="docutils literal notranslate"><span class="pre">skew</span></code>, <code class="docutils literal notranslate"><span class="pre">kurtosis</span></code>, we need to use <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># IQR (Scale Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IQR: &quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">iqr</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Skewness (Shape Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skewness: &quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Kurtosis (Shape Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kurtosis: &quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># You can also quickly get descriptive statistics with a single function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Descriptive statistics:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IQR:  [2.5   3.25  2.375 3.375 2.25 ]
Skewness:  [ 0.54309084  0.24394285  0.80172768 -0.11813453  0.34616807]
Kurtosis:  [ 1.5        -0.41610621  2.53815357 -0.32082096 -0.768431  ]
Descriptive statistics:
 DescribeResult(nobs=4, minmax=(array([8. , 7. , 9. , 7. , 9.5]), array([15. , 14. , 17. , 14.5, 14. ])), mean=array([11.   , 10.25 , 12.125, 10.875, 11.5  ]), variance=array([ 8.66666667,  8.91666667, 11.72916667, 10.0625    ,  3.83333333]), skewness=array([ 0.54309084,  0.24394285,  0.80172768, -0.11813453,  0.34616807]), kurtosis=array([-1.        , -1.25548083, -0.86157952, -1.24277613, -1.30245747]))
</pre></div>
</div>
</div>
</div>
<p>As we often use <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to handle data, we could use the Pandas function <code class="docutils literal notranslate"><span class="pre">describe()</span></code> to have an instant look at common statistics of the DataFrame (or Series). Next is an example of summarizing daily rainfall.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">dr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../assets/data/Changi_daily_rainfall.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dr</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dr</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            Daily Rainfall Total (mm)
Date                                 
1981-01-01                        0.0
1981-01-02                        0.0
1981-01-03                        0.0
1981-01-04                        0.0
1981-01-05                        0.0
       Daily Rainfall Total (mm)
count               14610.000000
mean                    5.721629
std                    14.194586
min                     0.000000
25%                     0.000000
50%                     0.000000
75%                     4.200000
max                   216.200000
</pre></div>
</div>
</div>
</div>
<p>We could also get specific statistics by directly operating on the DataFrame. In this case, the unbiased estimator is used by default.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mean (Location Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dr</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># Median (Location Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dr</span><span class="o">.</span><span class="n">median</span><span class="p">())</span>

<span class="c1"># Variance (Scale Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dr</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>

<span class="c1"># Skewness (Shape Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dr</span><span class="o">.</span><span class="n">skew</span><span class="p">())</span>

<span class="c1"># Kurtosis (Shape Parameter)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dr</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Daily Rainfall Total (mm)    5.721629
dtype: float64
Daily Rainfall Total (mm)    0.0
dtype: float64
Daily Rainfall Total (mm)    201.486277
dtype: float64
Daily Rainfall Total (mm)    5.130516
dtype: float64
Daily Rainfall Total (mm)    40.832293
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="distributions">
<h2><span class="section-number">4.1.2. </span>Distributions<a class="headerlink" href="#distributions" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> contains a lot of objects for probability distributions, including <strong>continuous distributions</strong> and <strong>discrete distributions</strong>.</p>
<ul class="simple">
<li><p><strong>Continuous distributions</strong></p></li>
</ul>
<p>Some examples are <code class="docutils literal notranslate"><span class="pre">norm</span></code> (normal distribution), <code class="docutils literal notranslate"><span class="pre">gamma</span></code> (gamma distribution), <code class="docutils literal notranslate"><span class="pre">uniform</span></code> (uniform distribution). Each object of continuous distributions comes with many useful methods, such as its PDF (probability density function), its CDF (cumulative distribution function), and so on.</p>
<p>Normally, we would directly import specific distributions into Python for convenience. Next is the example of a normal distribution whose mean is 5 and standard deviation is 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">PDF</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># generate PDF in bins</span>
<span class="n">CDF</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># generate CDF in bins</span>
<span class="n">SF</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># generate survival function (1-CDF)</span>
<span class="n">PPF</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># obtain percent point (inverse of CDF)</span>
<span class="n">RVS</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># generate 1000 random variates</span>
<span class="n">MMS</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mvsk&#39;</span><span class="p">)</span>  <span class="c1"># obtain the four moments</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">PDF</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;PDF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">CDF</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;CDF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/363eab40258a86a65250ee8737885cd4f2d492962163c598142d7a6072a888aa.png" src="../../_images/363eab40258a86a65250ee8737885cd4f2d492962163c598142d7a6072a888aa.png" />
<img alt="../../_images/dd6d52ae19d866020ee83bf371c78b568374b205c329f230cc320d149fc54a8a.png" src="../../_images/dd6d52ae19d866020ee83bf371c78b568374b205c329f230cc320d149fc54a8a.png" />
</div>
</div>
<p>One common practice is to fit a dataset into a distribution. Next is an example.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Note on SciPy version</p>
<p>If you are using SciPy locally with a version former than 1.7.0, the choice of <code class="docutils literal notranslate"><span class="pre">method</span></code> in <code class="docutils literal notranslate"><span class="pre">fit()</span></code> is not supported, which leads to the error <code class="docutils literal notranslate"><span class="pre">TypeError:</span> <span class="pre">Unknown</span> <span class="pre">arguments:</span> <span class="pre">{'method':</span> <span class="pre">'MLE'}</span></code> when running the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> function. The solution is to remove the choice of <code class="docutils literal notranslate"><span class="pre">method</span></code> (i.e. <code class="docutils literal notranslate"><span class="pre">mu,</span> <span class="pre">sigma</span> <span class="pre">=</span> <span class="pre">norm.fit(samples)</span></code>).</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># pesudo dataset</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;MLE&quot;</span><span class="p">)</span>  <span class="c1"># do a maximum-likelihood fit</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

<span class="c1"># Plot figure</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span>
         <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Samples&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">),</span>
         <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.055650656764304 2.0756534192971463
</pre></div>
</div>
<img alt="../../_images/ed12e40e339fb9b2d6c456dd2c6197980b240b8f9ecc3460c698f6c9949085fc.png" src="../../_images/ed12e40e339fb9b2d6c456dd2c6197980b240b8f9ecc3460c698f6c9949085fc.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The distribution objects in <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> could be employed in two ways. The first is to input distribution parameters every time, as in the example above. The other way is to create a <strong>“frozen” distribution</strong> object by fixing the distribution parameters. For example, <code class="docutils literal notranslate"><span class="pre">distr</span> <span class="pre">=</span> <span class="pre">norm(loc=5,</span> <span class="pre">scale=2)</span></code>. The example in the following section of discrete distributions employs this way.</p>
</div>
<ul class="simple">
<li><p><strong>Discrete distributions</strong></p></li>
</ul>
<p>Some examples are <code class="docutils literal notranslate"><span class="pre">bernoulli</span></code> (Bernoulli distribution), <code class="docutils literal notranslate"><span class="pre">binom</span></code> (binomial distribution), <code class="docutils literal notranslate"><span class="pre">poisson</span></code> (poisson distribution). Similarly, each object of discrete distributions comes with some useful methods, such as its PMF (probability mass function), its CDF (cumulative distribution function), and so on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.4</span>
<span class="n">distr</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>  <span class="c1"># frozen distribution</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">PMF</span> <span class="o">=</span> <span class="n">distr</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># generate PMF in x</span>
<span class="n">CDF</span> <span class="o">=</span> <span class="n">distr</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># generate CDF in x</span>
<span class="n">MMS</span> <span class="o">=</span> <span class="n">distr</span><span class="o">.</span><span class="n">stats</span><span class="p">(</span><span class="n">moments</span><span class="o">=</span><span class="s1">&#39;mvsk&#39;</span><span class="p">)</span>  <span class="c1"># obtain the four moments</span>
<span class="n">RVS</span> <span class="o">=</span> <span class="n">distr</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># generate random variates</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PMF</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">PMF</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;PMF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">CDF</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">CDF</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;CDF&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/72d892d43741cbf63021ca12df30437366e4fed4465a94ddbbc4901d2c3026b6.png" src="../../_images/72d892d43741cbf63021ca12df30437366e4fed4465a94ddbbc4901d2c3026b6.png" />
<img alt="../../_images/0a4f71d9cc093e29ab09b5884281e27f0738078c7e7734f6fad08d3fee9e7d5e.png" src="../../_images/0a4f71d9cc093e29ab09b5884281e27f0738078c7e7734f6fad08d3fee9e7d5e.png" />
</div>
</div>
<p>For a full list of probability distributions in <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>, please refer to this <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#probability-distributions">official website</a>.</p>
</section>
<section id="statistical-tests">
<h2><span class="section-number">4.1.3. </span>Statistical Tests<a class="headerlink" href="#statistical-tests" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> contains a lot of common statistical tests, such as <code class="docutils literal notranslate"><span class="pre">ttest_ind</span></code> (T-test for the means of two independent samples), <code class="docutils literal notranslate"><span class="pre">kstest</span></code> (Kolmogorov-Smirnov test for goodness of fit) and so on.</p>
<p>For instance, if we have two sets of observations that we assume are generated from Gaussian processes, we can use a T-test <code class="docutils literal notranslate"><span class="pre">stats.ttest_ind</span></code> to decide whether the means of two sets of observations are significantly different.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Sample A</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>   <span class="c1"># Sample B</span>
<span class="n">T</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>          <span class="c1"># T-test</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-3.3344152893762242 0.0011719701545575287
</pre></div>
</div>
</div>
</div>
<p>The resulting output in this case is composed of:</p>
<ul class="simple">
<li><p>T statistic value: a number the sign of which is proportional to the difference between the two random processes and the magnitude is related to the significance of this difference.</p></li>
<li><p>p value: the probability of both processes being identical. If it is close to 1, the two processes are almost certainly identical. The closer it is to zero, the more likely it is that the processes have different means.</p></li>
</ul>
<p>For a full list of supported statistical tests in <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>, please refer to this <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#statistical-tests">official website</a>.</p>
</section>
<section id="correlations">
<h2><span class="section-number">4.1.4. </span>Correlations<a class="headerlink" href="#correlations" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> contains some basic correlation functions, such as <code class="docutils literal notranslate"><span class="pre">pearsonr</span></code> (Pearson correlation coefficient), <code class="docutils literal notranslate"><span class="pre">spearmanr</span></code> (Spearman correlation coefficient), <code class="docutils literal notranslate"><span class="pre">kendalltau</span></code> (Kendall’s tau correlation measure). Next is an example of Kendall’s tau correlation for annual rainfall.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../assets/data/Changi_daily_rainfall.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">yr</span> <span class="o">=</span> <span class="n">dr</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># aggregate annual rainfall total</span>
<span class="n">yr</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">yr</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
<span class="n">yr</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Yearly Rainfall Total (mm)&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">yr</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">tau</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kendalltau</span><span class="p">(</span><span class="n">yr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">yr</span><span class="p">)</span>
<span class="c1"># tau is Kendall’s tau measure and p is the corresponding p-value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Yearly Rainfall Total (mm)
Date                            
1981                      1336.3
1982                      1581.7
1983                      1866.5
1984                      2686.7
1985                      1483.9
-0.0358974358974359 0.7442511261559122
</pre></div>
</div>
</div>
</div>
<p>For more advanced regression models, you may refer to <a class="reference external" href="https://www.statsmodels.org/stable/api.html?highlight=regression">statistical model package</a> <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> or the <a class="reference external" href="https://scikit-learn.org/stable/supervised_learning.html#supervised-learning">machine learning package</a> <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>. A brief beginner guide of this could also be found in <a class="reference external" href="https://realpython.com/linear-regression-in-python/">RealPython</a>.</p>
</section>
<section id="extreme-value-analysis">
<h2><span class="section-number">4.1.5. </span>Extreme Value Analysis<a class="headerlink" href="#extreme-value-analysis" title="Permalink to this heading">#</a></h2>
<p>Extreme value analysis (EVA) is a process primarily to estimate the probability of events that are more extreme than any previously observed. It is widely applied in many fields such as engineering, meteorology, hydrology, finance, etc. For example, we could use EVA to estimate the probability distributions of extreme hydrological events and correspondingly estimate the magnitudes of extreme hydrological events under specific return periods.</p>
<p>In this section, we will take a time series of streamflow as an example to show the extreme value analysis for <u><strong>annual 5-day low-flow</strong></u> in Python step by step.</p>
<section id="extract-extreme-values">
<h3><span class="section-number">4.1.5.1. </span>Extract extreme values<a class="headerlink" href="#extract-extreme-values" title="Permalink to this heading">#</a></h3>
<p>We first load the daily streamflow data from the file using <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and calculate the 5-day moving average of streamflow. Extreme events are collected from each year by picking the minimum 5-day low-flow.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Data</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../assets/data/Streamflow_02401390.dat&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> 
                 <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Streamflow&quot;</span><span class="p">]</span>
<span class="n">ds</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Date&#39;</span>
<span class="n">ds</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Streamflow</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1981-01-01</th>
      <td>40.0</td>
    </tr>
    <tr>
      <th>1981-01-02</th>
      <td>39.0</td>
    </tr>
    <tr>
      <th>1981-01-03</th>
      <td>41.0</td>
    </tr>
    <tr>
      <th>1981-01-04</th>
      <td>39.0</td>
    </tr>
    <tr>
      <th>1981-01-05</th>
      <td>37.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate 5-day flow</span>
<span class="n">ds5day</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># moving average</span>
<span class="n">ds5day</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;5-day flow&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds5day</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Extract annual low-flow</span>
<span class="n">lowf</span> <span class="o">=</span> <span class="n">ds5day</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>  <span class="c1"># yearly minimum</span>
<span class="n">lowf</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">lowf</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span>
<span class="n">lowf</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Annual low-flow&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lowf</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Plot annual 5-day low-flow</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lowf</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Low-flow ($m^3/s$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            5-day flow
Date                  
1981-01-01         NaN
1981-01-02         NaN
1981-01-03        39.2
1981-01-04        38.4
1981-01-05        39.4
      Annual low-flow
Date                 
1981             11.2
1982             19.2
1983             19.8
1984             17.6
1985             25.4
</pre></div>
</div>
<img alt="../../_images/b9e42ef7b859a56f11c87f240c7bd748d1320f534e5c91b7014f5ca8abaf9d26.png" src="../../_images/b9e42ef7b859a56f11c87f240c7bd748d1320f534e5c91b7014f5ca8abaf9d26.png" />
</div>
</div>
</section>
<section id="fit-distribution-parameter-estimation">
<h3><span class="section-number">4.1.5.2. </span>Fit distribution (parameter estimation)<a class="headerlink" href="#fit-distribution-parameter-estimation" title="Permalink to this heading">#</a></h3>
<p>Next, we fit a distribution to the annual low-flow extreme events. Here, we assume that annual low-flow follows a generalized extreme value (GEV) distribution <code class="docutils literal notranslate"><span class="pre">genextreme(c,</span> <span class="pre">loc=loc,</span> <span class="pre">scale=scale)</span></code>, which has three parameters: <code class="docutils literal notranslate"><span class="pre">loc</span></code> (location parameter), <code class="docutils literal notranslate"><span class="pre">scale</span></code> (scale parameter) and <code class="docutils literal notranslate"><span class="pre">c</span></code> (shape parameter).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">genextreme</span> <span class="k">as</span> <span class="n">gev</span>
</pre></div>
</div>
</div>
</div>
<p>Here, we introduce two methods to estimate the parameters, including the <strong>maximum likelihood method (MLE)</strong> and the <strong>method of L-moments</strong>.</p>
<ul class="simple">
<li><p>Maximum likelihood method (MLE)</p></li>
</ul>
<aside class="margin sidebar">
<p class="sidebar-title">Note on SciPy version</p>
<p>If you are using SciPy locally with a version former than 1.7.0, there will be accidental <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> when running the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> function. This is due to the incompatibility of <code class="docutils literal notranslate"><span class="pre">fit()</span></code> function with DataFrame in old versions. The solution is to only input values (NumPy Array) in fitting (i.e. <code class="docutils literal notranslate"><span class="pre">c0,</span> <span class="pre">loc0,</span> <span class="pre">scale0</span>&#160; <span class="pre">=</span> <span class="pre">gev.fit(lowf.values)</span></code>).</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c0</span><span class="p">,</span> <span class="n">loc0</span><span class="p">,</span> <span class="n">scale0</span>  <span class="o">=</span> <span class="n">gev</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">lowf</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;MLE&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc0</span><span class="p">,</span> <span class="n">scale0</span><span class="p">,</span> <span class="n">c0</span><span class="p">)</span>
<span class="n">MLEGEV</span> <span class="o">=</span> <span class="n">gev</span><span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale0</span><span class="p">)</span>  <span class="c1"># Frozen distribution</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.808425716808408 5.941316015077605 0.16158787388446866
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Method of L-moments (LMM)</p></li>
</ul>
<p>In the context of EVA, observations tend to follow a distribution more complicated than the normal distribution. The method of L-moments is more recommended in this case compared to MLE (more details referred to <a class="reference external" href="https://en.wikipedia.org/wiki/L-moment#:~:text=L%2Dmoments%20are%20far%20more%20meaningful%20when%20dealing%20with%20outliers%20in%20data%20than%20conventional%20moments">WikiPedia</a>). However, <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> only includes the common MLE method and method of moments for parameter estimation. We need to code the method of L-moments on our own.</p>
<p>The L-moments are established based on the probability weighted moments. To be specific, they are linear combinations of probability weighted moments. The probability weighted moments are defined as</p>
<p><span class="math notranslate nohighlight">\(
\begin{align}
&amp; \beta_0=\int_{0}^{1} F^{-1}(p)p^0\text{d}p\\
&amp; \beta_1=\int_{0}^{1} F^{-1}(p)p^1\text{d}p \tag{1}\\
&amp; \beta_2=\int_{0}^{1} F^{-1}(p)p^2\text{d}p\\
\end{align}
\)</span></p>
<p>where <span class="math notranslate nohighlight">\(x\)</span> is the random variable of interest, <span class="math notranslate nohighlight">\(F(x)\)</span> is the cumulative distribution, and <span class="math notranslate nohighlight">\(F^{-1}(p)\)</span> is the inverse of cumulative distribution.</p>
<p>The basic idea of the method of L-moments is to <strong>use sample L-moments as the estimates of population L-moments</strong>. Then, if we could get the relationships between the population L-moments and the distribution parameters, we could get the estimates of parameters by plugging sample L-moments. In order to calculate L-moments of samples, we need to calculate probability weighted moments of samples at first. Assume a set of samples <span class="math notranslate nohighlight">\(X_j\ (X_1&gt;X_2&gt;...&gt;X_n)\)</span>, probability weighted moments of samples are</p>
<p><span class="math notranslate nohighlight">\(
\begin{align}
&amp; b_0=\overline{X} \\
&amp; b_1=\sum_{j=1}^{n-1} \frac{(n-j)X_j}{n(n-1)} \tag{2}\\
&amp; b_2=\sum_{j=1}^{n-2} \frac{(n-j)(n-j-1)X_j}{n(n-1)(n-2)}\\
\end{align}
\)</span></p>
<p>where <span class="math notranslate nohighlight">\(b_0, b_1, b_2\)</span> are the first three unbiased probability weighted moments of samples.</p>
<p>The relationship between the first three L-moments and probability weighted moments are</p>
<p><span class="math notranslate nohighlight">\(
\begin{align}
&amp; \lambda_1=b_0\\
&amp; \lambda_2=2b_1-b_0 \tag{3}\\
&amp; \lambda_3=6b_2-6b_1+b_0\\
\end{align}
\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2, \lambda_3\)</span> are the first three L-moments. By plugging equation (2) into equation (3), we could obtain the sample L-moments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate samples L-moments</span>

<span class="k">def</span> <span class="nf">samlmom3</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    samlmom3 returns the first three L-moments of samples</span>
<span class="sd">    sample is the 1-d array</span>
<span class="sd">    n is the total number of the samples, j is the j_th sample</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">b0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">n</span> <span class="o">-</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sample</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">n</span> <span class="o">-</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sample</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">lmom1</span> <span class="o">=</span> <span class="n">b0</span>
    <span class="n">lmom2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">-</span> <span class="n">b0</span>
    <span class="n">lmom3</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="p">(</span><span class="n">b2</span> <span class="o">-</span> <span class="n">b1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b0</span>

    <span class="k">return</span> <span class="n">lmom1</span><span class="p">,</span> <span class="n">lmom2</span><span class="p">,</span> <span class="n">lmom3</span>


<span class="n">LMM</span> <span class="o">=</span> <span class="n">samlmom3</span><span class="p">(</span><span class="n">lowf</span><span class="p">[</span><span class="s2">&quot;Annual low-flow&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LMM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(18.5, 3.8837241379310328, 0.37207881773398555)
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://www.jstor.org/stable/2345653?origin=JSTOR-pdf">Hosking (1990; Table 1)</a> has proven that for the GEV distribution, the relationships between the L-moments and distribution parameters are</p>
<p><span class="math notranslate nohighlight">\(
\begin{align}
\lambda_1 &amp; =\mu+\sigma[1-\Gamma(1+\xi)]/\xi \\
\lambda_2 &amp; =\sigma(1-2^{-\xi})\Gamma(1+\xi)/\xi \tag{4} \\
\frac{\lambda_3}{\lambda_2} &amp; =\frac{2(1-3^{-\xi})}{1-2^{-\xi}}-3
\end{align}
\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\mu, \sigma, \xi\)</span> are respectively GEV’s location <code class="docutils literal notranslate"><span class="pre">loc</span></code>, scale <code class="docutils literal notranslate"><span class="pre">scale</span></code>, and shape <code class="docutils literal notranslate"><span class="pre">c</span></code> parameters. Obviously, there are no explicit solutions to these equations when we plugin the sample L-moments. Luckily, we could resort to the function solver <code class="docutils literal notranslate"><span class="pre">scipy.optimize.fsolve</span></code> in the optimization sub-module of SciPy to get numerical solutions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate GEV parameters using the function solver</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">pargev_fsolve</span><span class="p">(</span><span class="n">lmom</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    pargev_fsolve estimates the parameters of the Generalized Extreme Value </span>
<span class="sd">    distribution given the L-moments of samples</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lmom_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="n">lmom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lmom</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lmom</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">lmom</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">-</span> <span class="n">t</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">2</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">para3</span> <span class="o">=</span> <span class="n">G</span>
    <span class="n">GAM</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">G</span><span class="p">)</span>
    <span class="n">para2</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">G</span> <span class="o">/</span> <span class="p">(</span><span class="n">GAM</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**-</span><span class="n">G</span><span class="p">))</span>
    <span class="n">para1</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">para2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">GAM</span><span class="p">)</span> <span class="o">/</span> <span class="n">G</span>
    <span class="k">return</span> <span class="n">para1</span><span class="p">,</span> <span class="n">para2</span><span class="p">,</span> <span class="n">para3</span>

<span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">pargev_fsolve</span><span class="p">(</span><span class="n">LMM</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.587575273199434 6.18294944388195 0.11881321836725452
</pre></div>
</div>
</div>
</div>
<p>Alternatively, a numerical approximation method for the solution of equation (4) was proposed by <a class="reference external" href="https://www.tandfonline.com/doi/abs/10.1080/03610919608813340">Donaldson (1996)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate GEV parameters using numerical approximations</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">special</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">pargev</span><span class="p">(</span><span class="n">lmom</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    pargev returns the parameters of the Generalized Extreme Value </span>
<span class="sd">    distribution given the L-moments of samples</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lmom_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="n">lmom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lmom</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lmom</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">lmom</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    
    <span class="n">SMALL</span> <span class="o">=</span> <span class="mf">1e-5</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">maxit</span> <span class="o">=</span> <span class="mi">20</span>
    
    <span class="c1"># EU IS EULER&#39;S CONSTANT</span>
    <span class="n">EU</span> <span class="o">=</span> <span class="mf">0.57721566</span>
    <span class="n">DL2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">DL3</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># COEFFICIENTS OF RATIONAL-FUNCTION APPROXIMATIONS FOR XI</span>
    <span class="n">A0</span> <span class="o">=</span> <span class="mf">0.28377530</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.21096399</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.50728214</span>
    <span class="n">A3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.13455566</span>
    <span class="n">A4</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.07138022</span>
    <span class="n">B1</span> <span class="o">=</span> <span class="mf">2.06189696</span>
    <span class="n">B2</span> <span class="o">=</span> <span class="mf">1.31912239</span>
    <span class="n">B3</span> <span class="o">=</span> <span class="mf">0.25077104</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="mf">1.59921491</span>
    <span class="n">C2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.48832213</span>
    <span class="n">C3</span> <span class="o">=</span> <span class="mf">0.01573152</span>
    <span class="n">D1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.64363929</span>
    <span class="n">D2</span> <span class="o">=</span> <span class="mf">0.08985247</span>
    
    <span class="n">T3</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">T3</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid L-Moments&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">T3</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">G</span> <span class="o">=</span> <span class="p">(</span><span class="n">A0</span> <span class="o">+</span> <span class="n">T3</span> <span class="o">*</span> <span class="p">(</span><span class="n">A1</span> <span class="o">+</span> <span class="n">T3</span> <span class="o">*</span> <span class="p">(</span><span class="n">A2</span> <span class="o">+</span> <span class="n">T3</span> <span class="o">*</span> <span class="p">(</span><span class="n">A3</span> <span class="o">+</span> <span class="n">T3</span> <span class="o">*</span> <span class="n">A4</span><span class="p">))))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">T3</span> <span class="o">*</span> <span class="p">(</span><span class="n">B1</span> <span class="o">+</span> <span class="n">T3</span> <span class="o">*</span> <span class="p">(</span><span class="n">B2</span> <span class="o">+</span> <span class="n">T3</span> <span class="o">*</span> <span class="n">B3</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">T3</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">:</span>
            <span class="n">para3</span> <span class="o">=</span> <span class="n">G</span>
            <span class="n">GAM</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">G</span><span class="p">))</span>
            <span class="n">para2</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">G</span> <span class="o">/</span> <span class="p">(</span><span class="n">GAM</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**-</span><span class="n">G</span><span class="p">))</span>
            <span class="n">para1</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">para2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">GAM</span><span class="p">)</span> <span class="o">/</span> <span class="n">G</span>
            <span class="k">return</span> <span class="n">para1</span><span class="p">,</span> <span class="n">para2</span><span class="p">,</span> <span class="n">para3</span>
        <span class="k">elif</span> <span class="n">T3</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">0.97</span><span class="p">:</span>
            <span class="n">G</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">T3</span><span class="p">)</span> <span class="o">/</span> <span class="n">DL2</span>

        <span class="n">T0</span> <span class="o">=</span> <span class="p">(</span><span class="n">T3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="k">for</span> <span class="n">IT</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxit</span><span class="p">):</span>
            <span class="n">X2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="o">-</span><span class="n">G</span>
            <span class="n">X3</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">**</span> <span class="o">-</span><span class="n">G</span>
            <span class="n">XX2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">X2</span>
            <span class="n">XX3</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">X3</span>
            <span class="n">T</span> <span class="o">=</span> <span class="n">XX3</span> <span class="o">/</span> <span class="n">XX2</span>
            <span class="n">DERIV</span> <span class="o">=</span> <span class="p">(</span><span class="n">XX2</span> <span class="o">*</span> <span class="n">X3</span> <span class="o">*</span> <span class="n">DL3</span> <span class="o">-</span> <span class="n">XX3</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">DL2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">XX2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">GOLD</span> <span class="o">=</span> <span class="n">G</span>
            <span class="n">G</span> <span class="o">-=</span> <span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="n">T0</span><span class="p">)</span> <span class="o">/</span> <span class="n">DERIV</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">G</span> <span class="o">-</span> <span class="n">GOLD</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">eps</span> <span class="o">*</span> <span class="n">G</span><span class="p">:</span>
                <span class="n">para3</span> <span class="o">=</span> <span class="n">G</span>
                <span class="n">GAM</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">G</span><span class="p">))</span>
                <span class="n">para2</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">G</span> <span class="o">/</span> <span class="p">(</span><span class="n">GAM</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**-</span><span class="n">G</span><span class="p">))</span>
                <span class="n">para1</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">para2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">GAM</span><span class="p">)</span> <span class="o">/</span> <span class="n">G</span>
                <span class="k">return</span> <span class="n">para1</span><span class="p">,</span> <span class="n">para2</span><span class="p">,</span> <span class="n">para3</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Iteration has not converged&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">T3</span>
        <span class="n">G</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Z</span> <span class="o">*</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">Z</span> <span class="o">*</span> <span class="p">(</span><span class="n">C2</span> <span class="o">+</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">C3</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Z</span> <span class="o">*</span> <span class="p">(</span><span class="n">D1</span> <span class="o">+</span> <span class="n">Z</span> <span class="o">*</span> <span class="n">D2</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SMALL</span><span class="p">:</span>
            <span class="n">para2</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">DL2</span>
            <span class="n">para1</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">EU</span> <span class="o">*</span> <span class="n">para2</span>
            <span class="n">para3</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">para3</span> <span class="o">=</span> <span class="n">G</span>
            <span class="n">GAM</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">special</span><span class="o">.</span><span class="n">gammaln</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">G</span><span class="p">))</span>
            <span class="n">para2</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">G</span> <span class="o">/</span> <span class="p">(</span><span class="n">GAM</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**-</span><span class="n">G</span><span class="p">))</span>
            <span class="n">para1</span> <span class="o">=</span> <span class="n">lmom_ratios</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">para2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">GAM</span><span class="p">)</span> <span class="o">/</span> <span class="n">G</span>
        <span class="k">return</span> <span class="n">para1</span><span class="p">,</span> <span class="n">para2</span><span class="p">,</span> <span class="n">para3</span>


<span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">pargev</span><span class="p">(</span><span class="n">LMM</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>
<span class="n">LMMGEV</span> <span class="o">=</span> <span class="n">gev</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale1</span><span class="p">)</span>  <span class="c1"># Frozen distribution</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.587575475184854 6.182949767501039 0.11881328920002591
</pre></div>
</div>
</div>
</div>
<p>We could observe that both the function solver and numerical approximations generate almost the same results of distribution parameters.</p>
</section>
<section id="compare-with-empirical-distribution">
<h3><span class="section-number">4.1.5.3. </span>Compare with empirical distribution<a class="headerlink" href="#compare-with-empirical-distribution" title="Permalink to this heading">#</a></h3>
<p>Although we have obtained the estimated probability distribution of annual low-flow by parameter estimation, it is necessary to examine its performance in characterizing the observation datasets. Here, we first examine this by directly looking at the <em><strong>probability density function (PDF)</strong></em> and <em><strong>cumulative distribution function (CDF)</strong></em>; then, we examine this through <em><strong>statistical inference</strong></em>.</p>
<ul class="simple">
<li><p>Probability density function</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot empirical PDF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lowf</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span>
         <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical PDF&#39;</span><span class="p">)</span>
<span class="c1"># Plot estimated PDF based on maximum likelihood method</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">MLEGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">MLEGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">MLEGEV</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span>
         <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated PDF (MLE)&#39;</span><span class="p">)</span>
<span class="c1"># Plot estimated PDF based on the method of L-moments</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">LMMGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">LMMGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">LMMGEV</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span>
         <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated PDF (LMM)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Annual 5-day Low-flow ($m^3/s$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/482d405e663e5ce968a3d1750b3b289ae6d1d611a6ea9a159da0b7548fe3a505.png" src="../../_images/482d405e663e5ce968a3d1750b3b289ae6d1d611a6ea9a159da0b7548fe3a505.png" />
</div>
</div>
<ul class="simple">
<li><p>Cumulative distribution function</p></li>
</ul>
<p>Since we are often more concerned about the rare cases of extreme events (which lay at the edge of PDF), it is also common practice to plot CDF to have a check.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot empirical CDF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lowf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Annual low-flow&quot;</span><span class="p">]),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lowf</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">/</span><span class="n">lowf</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orangered&#39;</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical CDF&#39;</span><span class="p">)</span>
<span class="c1"># Plot estimated PDF based on maximum likelihood method</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">MLEGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">MLEGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">MLEGEV</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span> 
         <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated CDF (MLE)&#39;</span><span class="p">)</span>
<span class="c1"># Plot estimated PDF based on the method of L-moments</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">LMMGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">LMMGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">LMMGEV</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span> 
         <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Estimated CDF (LMM)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Annual 5-day Low-flow ($m^3/s$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cdcbfaa42d613be62ec9a647c64bff802fa0c90e6b40efd80155b9715a24fb9b.png" src="../../_images/cdcbfaa42d613be62ec9a647c64bff802fa0c90e6b40efd80155b9715a24fb9b.png" />
</div>
</div>
<ul class="simple">
<li><p>Statistical inference: Kolmogorov-Smirnov (KS) test</p></li>
</ul>
<p>There are several tests available to test the performances of distribution fits. Here we used the Kolmogorov-Smirnov (KS) test, which is available in <code class="docutils literal notranslate"><span class="pre">scipy.stats.kstest</span></code>. This is a two-sided test for the null hypothesis that <strong>the distribution of independent samples is identical to the specified cumulative distribution</strong>. If the KS statistic is small or the p-value is high, then we cannot reject the hypothesis that samples follow the specified distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MLEKS</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">lowf</span><span class="p">[</span><span class="s2">&quot;Annual low-flow&quot;</span><span class="p">],</span> <span class="n">MLEGEV</span><span class="o">.</span><span class="n">cdf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MLEKS</span><span class="p">)</span>
<span class="n">LMMKS</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">lowf</span><span class="p">[</span><span class="s2">&quot;Annual low-flow&quot;</span><span class="p">],</span> <span class="n">LMMGEV</span><span class="o">.</span><span class="n">cdf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LMMKS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KstestResult(statistic=0.16008786925974927, pvalue=0.3845846196401085)
KstestResult(statistic=0.14516854345180497, pvalue=0.5061871580723805)
</pre></div>
</div>
</div>
</div>
</section>
<section id="estimate-extreme-values-for-specific-return-periods">
<h3><span class="section-number">4.1.5.4. </span>Estimate extreme values for specific return periods<a class="headerlink" href="#estimate-extreme-values-for-specific-return-periods" title="Permalink to this heading">#</a></h3>
<p>One goal of EVA is to estimate the extreme values corresponding to some return periods. In the case of low-flow, the relationship between the non-exceedance probability and the return period is</p>
<div class="math notranslate nohighlight">
\[P(X\leq x_{T})=\frac{1}{T}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_{T}\)</span> is the extreme annual 5-day low-flow corresponding to the return period of <span class="math notranslate nohighlight">\(T\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># return periods from 2 years to 1000 years</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>

<span class="c1"># extreme low-flow under each return period</span>
<span class="n">LFTmle</span> <span class="o">=</span> <span class="n">MLEGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span>
<span class="n">LFTmle</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">LFTmle</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Annual 5-day low-flow&quot;</span><span class="p">])</span>
<span class="n">LFTmle</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Return period&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LFTmle</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]])</span>

<span class="n">LFTlmm</span> <span class="o">=</span> <span class="n">LMMGEV</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span>
<span class="n">LFTlmm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">LFTlmm</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Annual 5-day low-flow&quot;</span><span class="p">])</span>
<span class="n">LFTlmm</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Return period&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LFTlmm</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]])</span>

<span class="c1"># Plot low-flow vs return periods</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">LFTmle</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MLE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">LFTlmm</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LMM&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Annual 5-day low-flow ($m^3/s$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Return period (years)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Annual 5-day low-flow
Return period                       
2                          17.922767
5                          12.869493
10                         10.503747
100                         5.517358
1000                        2.330862
               Annual 5-day low-flow
Return period                       
2                          17.805074
5                          12.560429
10                         10.166638
100                         5.234184
1000                        2.154865
</pre></div>
</div>
<img alt="../../_images/309743d77f6dd2bc05f342895981444749d04dd96be7f6415888c1754c975142.png" src="../../_images/309743d77f6dd2bc05f342895981444749d04dd96be7f6415888c1754c975142.png" />
</div>
</div>
</section>
</section>
<section id="references">
<h2><span class="section-number">4.1.6. </span>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>This tutorial was edited based on <a class="reference external" href="https://realpython.com/python-statistics/">Python Statistics Fundamentals</a>, <a class="reference external" href="https://scipy-lectures.org/">Scipy Lecture Notes</a>, <a class="reference external" href="https://github.com/royalosyin/A-Beginner-Guide-to-Carry-out-Extreme-Value-Analysis-with-Codes-in-Python">royalosyin’s guide to carry out EVA</a> and <a class="reference external" href="https://github.com/OpenHydrology/lmoments3">OpenHydrology’s lmoments3 repository</a>.</p></li>
<li><p>Only the <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> sub-module is introduced here. If you wish to get a quick glimpse on other sub-modules of SciPy, you could refer to <a class="reference external" href="https://scipy-lectures.org/intro/scipy.html">scipy-lectures</a>.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "ce3201"
        },
        kernelOptions: {
            name: "ce3201",
            path: "./chapters/data-analytics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ce3201'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="scipy.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>What is SciPy?</p>
      </div>
    </a>
    <a class="right-next"
       href="scipy-exercise.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.2. </span>SciPy Exercise</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics">4.1.1. Descriptive Statistics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distributions">4.1.2. Distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-tests">4.1.3. Statistical Tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlations">4.1.4. Correlations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extreme-value-analysis">4.1.5. Extreme Value Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-extreme-values">4.1.5.1. Extract extreme values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-distribution-parameter-estimation">4.1.5.2. Fit distribution (parameter estimation)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-with-empirical-distribution">4.1.5.3. Compare with empirical distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-extreme-values-for-specific-return-periods">4.1.5.4. Estimate extreme values for specific return periods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">4.1.6. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Xiaogang HE
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>